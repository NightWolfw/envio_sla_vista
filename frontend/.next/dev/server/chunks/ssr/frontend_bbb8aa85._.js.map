{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Bots/Git/envio_sla_vista/frontend/lib/client.ts"],"sourcesContent":["\"use client\";\n\nconst API_BASE = process.env.NEXT_PUBLIC_API_BASE_URL ?? \"http://localhost:5000/api\";\n\ntype Method = \"GET\" | \"POST\" | \"PUT\" | \"DELETE\";\n\nasync function request<T>(path: string, method: Method, body?: unknown): Promise<T> {\n  const res = await fetch(`${API_BASE}${path}`, {\n    method,\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    body: body ? JSON.stringify(body) : undefined\n  });\n\n  if (!res.ok) {\n    const text = await res.text();\n    throw new Error(text || `Erro ${res.status}`);\n  }\n\n  if (res.status === 204) {\n    return {} as T;\n  }\n\n  return res.json() as Promise<T>;\n}\n\nexport const clientApi = {\n  put: <T>(path: string, body?: unknown) => request<T>(path, \"PUT\", body),\n  post: <T>(path: string, body?: unknown) => request<T>(path, \"POST\", body),\n  delete: <T>(path: string, body?: unknown) => request<T>(path, \"DELETE\", body)\n};\n"],"names":[],"mappings":";;;;AAAA;AAEA,MAAM,WAAW,QAAQ,GAAG,CAAC,wBAAwB,IAAI;AAIzD,eAAe,QAAW,IAAY,EAAE,MAAc,EAAE,IAAc;IACpE,MAAM,MAAM,MAAM,MAAM,GAAG,WAAW,MAAM,EAAE;QAC5C;QACA,SAAS;YACP,gBAAgB;QAClB;QACA,MAAM,OAAO,KAAK,SAAS,CAAC,QAAQ;IACtC;IAEA,IAAI,CAAC,IAAI,EAAE,EAAE;QACX,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,MAAM,IAAI,MAAM,QAAQ,CAAC,KAAK,EAAE,IAAI,MAAM,EAAE;IAC9C;IAEA,IAAI,IAAI,MAAM,KAAK,KAAK;QACtB,OAAO,CAAC;IACV;IAEA,OAAO,IAAI,IAAI;AACjB;AAEO,MAAM,YAAY;IACvB,KAAK,CAAI,MAAc,OAAmB,QAAW,MAAM,OAAO;IAClE,MAAM,CAAI,MAAc,OAAmB,QAAW,MAAM,QAAQ;IACpE,QAAQ,CAAI,MAAc,OAAmB,QAAW,MAAM,UAAU;AAC1E"}},
    {"offset": {"line": 36, "column": 0}, "map": {"version":3,"sources":["file:///C:/Bots/Git/envio_sla_vista/frontend/app/mensagens/table.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\nimport type { Grupo, Mensagem } from \"../../lib/api\";\nimport { clientApi } from \"../../lib/client\";\n\ntype Props = {\n  mensagens: Mensagem[];\n  grupos: Grupo[];\n};\n\nexport default function MensagensClient({ mensagens, grupos }: Props) {\n  const [feedback, setFeedback] = useState<string | null>(null);\n\n  async function handleCreate(event: React.FormEvent<HTMLFormElement>) {\n    event.preventDefault();\n    const form = new FormData(event.currentTarget);\n    const gruposSelec = form.getAll(\"grupos\") as string[];\n    const dias = form\n      .getAll(\"dias_semana\")\n      .map((value) => Number(value))\n      .filter((n) => !Number.isNaN(n));\n\n    try {\n      await clientApi.post(\"/mensagens\", {\n        mensagem: form.get(\"mensagem\"),\n        grupos_ids: gruposSelec,\n        tipo_recorrencia: form.get(\"tipo_recorrencia\"),\n        dias_semana: dias.length ? dias : null,\n        horario: form.get(\"horario\"),\n        data_inicio: form.get(\"data_inicio\"),\n        data_fim: form.get(\"data_fim\") || null\n      });\n      event.currentTarget.reset();\n      setFeedback(\"Mensagem criada! Recarregue para visualizar.\");\n    } catch (error: any) {\n      setFeedback(error.message ?? \"Erro ao criar mensagem\");\n    }\n  }\n\n  async function toggleMensagem(id: number) {\n    try {\n      await clientApi.post(`/mensagens/${id}/toggle`);\n      setFeedback(\"Status alterado! Atualize para ver o resultado.\");\n    } catch (error: any) {\n      setFeedback(error.message ?? \"Erro ao alternar status\");\n    }\n  }\n\n  return (\n    <div style={{ display: \"grid\", gap: \"1.5rem\" }}>\n      <div style={{ overflowX: \"auto\" }}>\n        <table>\n          <thead>\n            <tr>\n              <th>ID</th>\n              <th>Mensagem</th>\n              <th>Tipo</th>\n              <th>Dias</th>\n              <th>Horário</th>\n              <th>Ativo</th>\n              <th></th>\n            </tr>\n          </thead>\n          <tbody>\n            {mensagens.map((mensagem) => (\n              <tr key={mensagem.id}>\n                <td>{mensagem.id}</td>\n                <td>{mensagem.mensagem.slice(0, 50)}...</td>\n                <td>{mensagem.tipo_recorrencia}</td>\n                <td>{mensagem.dias_semana?.join(\", \") ?? \"—\"}</td>\n                <td>{mensagem.horario}</td>\n                <td>{mensagem.ativo ? \"Sim\" : \"Não\"}</td>\n                <td>\n                  <button type=\"button\" onClick={() => toggleMensagem(mensagem.id)}>\n                    Alternar\n                  </button>\n                </td>\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      </div>\n\n      <form className=\"panel\" onSubmit={handleCreate}>\n        <h3>Criar nova mensagem</h3>\n        <div className=\"grid\" style={{ gap: \"0.75rem\" }}>\n          <label>\n            Mensagem\n            <textarea name=\"mensagem\" required rows={4} />\n          </label>\n          <label>\n            Grupos\n            <select name=\"grupos\" multiple required size={5}>\n              {grupos.map((grupo) => (\n                <option key={grupo.id} value={grupo.group_id}>\n                  {grupo.nome_grupo}\n                </option>\n              ))}\n            </select>\n          </label>\n          <label>\n            Tipo\n            <select name=\"tipo_recorrencia\" defaultValue=\"UNICA\">\n              <option value=\"UNICA\">Única</option>\n              <option value=\"RECORRENTE\">Recorrente</option>\n            </select>\n          </label>\n          <label>\n            Dias semana (0=Dom ... 6=Sáb)\n            <input name=\"dias_semana\" placeholder=\"0,1,2\" />\n          </label>\n          <label>\n            Horário\n            <input type=\"time\" name=\"horario\" required />\n          </label>\n          <label>\n            Data início\n            <input type=\"date\" name=\"data_inicio\" required />\n          </label>\n          <label>\n            Data fim (opcional)\n            <input type=\"date\" name=\"data_fim\" />\n          </label>\n          <button type=\"submit\">Salvar mensagem</button>\n        </div>\n        {feedback && <p style={{ marginTop: \"0.75rem\" }}>{feedback}</p>}\n      </form>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}