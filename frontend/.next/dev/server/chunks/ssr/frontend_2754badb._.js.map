{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Bots/Git/envio_sla_vista/frontend/lib/client.ts"],"sourcesContent":["\"use client\";\n\nconst API_BASE = process.env.NEXT_PUBLIC_API_BASE_URL ?? \"http://localhost:5000/api\";\n\ntype Method = \"GET\" | \"POST\" | \"PUT\" | \"DELETE\";\n\nasync function request<T>(path: string, method: Method, body?: unknown): Promise<T> {\n  const res = await fetch(`${API_BASE}${path}`, {\n    method,\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    body: body ? JSON.stringify(body) : undefined\n  });\n\n  if (!res.ok) {\n    const text = await res.text();\n    throw new Error(text || `Erro ${res.status}`);\n  }\n\n  if (res.status === 204) {\n    return {} as T;\n  }\n\n  return res.json() as Promise<T>;\n}\n\nexport const clientApi = {\n  put: <T>(path: string, body?: unknown) => request<T>(path, \"PUT\", body),\n  post: <T>(path: string, body?: unknown) => request<T>(path, \"POST\", body),\n  delete: <T>(path: string, body?: unknown) => request<T>(path, \"DELETE\", body)\n};\n"],"names":[],"mappings":";;;;AAAA;AAEA,MAAM,WAAW,QAAQ,GAAG,CAAC,wBAAwB,IAAI;AAIzD,eAAe,QAAW,IAAY,EAAE,MAAc,EAAE,IAAc;IACpE,MAAM,MAAM,MAAM,MAAM,GAAG,WAAW,MAAM,EAAE;QAC5C;QACA,SAAS;YACP,gBAAgB;QAClB;QACA,MAAM,OAAO,KAAK,SAAS,CAAC,QAAQ;IACtC;IAEA,IAAI,CAAC,IAAI,EAAE,EAAE;QACX,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,MAAM,IAAI,MAAM,QAAQ,CAAC,KAAK,EAAE,IAAI,MAAM,EAAE;IAC9C;IAEA,IAAI,IAAI,MAAM,KAAK,KAAK;QACtB,OAAO,CAAC;IACV;IAEA,OAAO,IAAI,IAAI;AACjB;AAEO,MAAM,YAAY;IACvB,KAAK,CAAI,MAAc,OAAmB,QAAW,MAAM,OAAO;IAClE,MAAM,CAAI,MAAc,OAAmB,QAAW,MAAM,QAAQ;IACpE,QAAQ,CAAI,MAAc,OAAmB,QAAW,MAAM,UAAU;AAC1E"}},
    {"offset": {"line": 36, "column": 0}, "map": {"version":3,"sources":["file:///C:/Bots/Git/envio_sla_vista/frontend/lib/api.ts"],"sourcesContent":["import { clientApi } from \"./client\";\n\nconst API_BASE =\n  process.env.NEXT_PUBLIC_API_BASE_URL ?? process.env.API_BASE_URL ?? \"http://localhost:5000/api\";\n\nasync function apiFetch<T>(path: string, init?: RequestInit): Promise<T> {\n  try {\n    const res = await fetch(`${API_BASE}${path}`, {\n      ...init,\n      headers: {\n        \"Content-Type\": \"application/json\",\n        ...(init?.headers ?? {})\n      },\n      cache: \"no-store\",\n      next: { revalidate: 0 }\n    });\n\n    if (!res.ok) {\n      const text = await res.text();\n      throw new Error(`Erro na API (${res.status}): ${text}`);\n    }\n\n    return res.json() as Promise<T>;\n  } catch (error) {\n    console.error(\"Falha ao buscar API\", error);\n    if (\n      error instanceof TypeError ||\n      (error instanceof Error && error.message.toLowerCase().includes(\"fetch failed\"))\n    ) {\n      throw new Error(\n        `Não foi possível conectar à API (${API_BASE}). Verifique se o backend FastAPI está rodando e se NEXT_PUBLIC_API_BASE_URL está configurado.`\n      );\n    }\n    throw error;\n  }\n}\n\nexport type OverviewStats = {\n  total_grupos: number;\n  total_mensagens: number;\n  total_envios: number;\n  generated_at: string;\n};\n\nexport async function getStats(): Promise<OverviewStats> {\n  return apiFetch<OverviewStats>(\"/stats\");\n}\n\nexport async function getDashboardResumo(params?: URLSearchParams) {\n  const query = params ? `?${params.toString()}` : \"\";\n  return apiFetch<{ data: any; periodo: any }>(\"/dashboard/resumo\" + query);\n}\n\nexport async function getDashboardTarefas(params?: URLSearchParams) {\n  const query = params ? `?${params.toString()}` : \"\";\n  return apiFetch<{ data: any[] }>(\"/dashboard/tarefas-mes\" + query);\n}\n\nexport async function getDashboardPizza(params?: URLSearchParams) {\n  const query = params ? `?${params.toString()}` : \"\";\n  return apiFetch<{ data: Record<string, number> }>(\"/dashboard/pizza\" + query);\n}\n\nexport type Grupo = {\n  id: number;\n  group_id: string;\n  nome_grupo: string;\n  envio: boolean;\n  cr?: string | null;\n  cliente?: string | null;\n  pec_01?: string | null;\n  pec_02?: string | null;\n  diretor_executivo?: string | null;\n  diretor_regional?: string | null;\n  gerente_regional?: string | null;\n  gerente?: string | null;\n  supervisor?: string | null;\n};\n\nexport async function getGrupos(): Promise<Grupo[]> {\n  return apiFetch<Grupo[]>(\"/grupos\");\n}\n\nexport async function getGrupoFiltros() {\n  return apiFetch(\"/grupos/filtros/meta\");\n}\n\nexport type Agendamento = {\n  id: number;\n  grupo_id: number;\n  nome_grupo: string;\n  cr: string | null;\n  tipo_envio: string;\n  dias_semana: string | null;\n  data_envio: string;\n  hora_inicio: string;\n  hora_fim: string;\n  ativo: boolean;\n};\n\nexport async function getAgendamentos(): Promise<Agendamento[]> {\n  return apiFetch<Agendamento[]>(\"/agendamentos\");\n}\n\nexport type Mensagem = {\n  id: number;\n  mensagem: string;\n  grupos_ids: string[];\n  tipo_recorrencia: string;\n  dias_semana: number[] | null;\n  horario: string;\n  data_inicio: string;\n  data_fim: string | null;\n  ativo: boolean;\n};\n\nexport async function getMensagens(params?: string): Promise<Mensagem[]> {\n  const suffix = params ? `?${params}` : \"\";\n  return apiFetch<Mensagem[]>(`/mensagens${suffix}`);\n}\n\nexport async function getSlaPreview(grupoId: number, payload: any) {\n  return apiFetch(`/sla/preview/${grupoId}`, {\n    method: \"POST\",\n    body: JSON.stringify(payload)\n  });\n}\n\nexport type EnvioGrupo = {\n  id: number;\n  group_id: string;\n  nome_grupo: string;\n  envio: boolean;\n  cr?: string | null;\n};\n\nexport async function getEnvioGrupos(): Promise<EnvioGrupo[]> {\n  return apiFetch<EnvioGrupo[]>(\"/envio/grupos\");\n}\n\nexport type EvolutionGroup = {\n  group_id: string;\n  nome: string;\n  cr?: string | null;\n};\n\nexport type EvolutionGroupsResponse = {\n  total: number;\n  page: number;\n  page_size: number;\n  grupos: EvolutionGroup[];\n};\n\nexport async function getEvolutionGroups(page = 1, pageSize = 25): Promise<EvolutionGroupsResponse> {\n  return apiFetch(`/evolution/groups?page=${page}&page_size=${pageSize}`);\n}\n\nexport async function getAllEvolutionGroups(): Promise<EvolutionGroupsResponse> {\n  return apiFetch(\"/evolution/groups/all\");\n}\n\nexport async function importEvolutionGroups(grupos: EvolutionGroup[]) {\n  return clientApi.post(\"/evolution/import\", { grupos });\n}\n\nexport type GrupoCrItem = {\n  id: number;\n  nome_grupo: string;\n  cr: string;\n};\n\nexport async function getGroupsWithCR(): Promise<GrupoCrItem[]> {\n  return apiFetch<GrupoCrItem[]>(\"/grupos/com-cr\");\n}\n\nexport async function syncGroupStructure(grupoId: number) {\n  return clientApi.post(`/grupos/${grupoId}/sync-estrutura`);\n}\n\nexport async function deleteGroups(ids: number[]) {\n  return clientApi.delete<{ removidos: number }>(\"/grupos\", { ids });\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AAEA,MAAM,WACJ,QAAQ,GAAG,CAAC,wBAAwB,IAAI,QAAQ,GAAG,CAAC,YAAY,IAAI;AAEtE,eAAe,SAAY,IAAY,EAAE,IAAkB;IACzD,IAAI;QACF,MAAM,MAAM,MAAM,MAAM,GAAG,WAAW,MAAM,EAAE;YAC5C,GAAG,IAAI;YACP,SAAS;gBACP,gBAAgB;gBAChB,GAAI,MAAM,WAAW,CAAC,CAAC;YACzB;YACA,OAAO;YACP,MAAM;gBAAE,YAAY;YAAE;QACxB;QAEA,IAAI,CAAC,IAAI,EAAE,EAAE;YACX,MAAM,OAAO,MAAM,IAAI,IAAI;YAC3B,MAAM,IAAI,MAAM,CAAC,aAAa,EAAE,IAAI,MAAM,CAAC,GAAG,EAAE,MAAM;QACxD;QAEA,OAAO,IAAI,IAAI;IACjB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,uBAAuB;QACrC,IACE,iBAAiB,aAChB,iBAAiB,SAAS,MAAM,OAAO,CAAC,WAAW,GAAG,QAAQ,CAAC,iBAChE;YACA,MAAM,IAAI,MACR,CAAC,iCAAiC,EAAE,SAAS,8FAA8F,CAAC;QAEhJ;QACA,MAAM;IACR;AACF;AASO,eAAe;IACpB,OAAO,SAAwB;AACjC;AAEO,eAAe,mBAAmB,MAAwB;IAC/D,MAAM,QAAQ,SAAS,CAAC,CAAC,EAAE,OAAO,QAAQ,IAAI,GAAG;IACjD,OAAO,SAAsC,sBAAsB;AACrE;AAEO,eAAe,oBAAoB,MAAwB;IAChE,MAAM,QAAQ,SAAS,CAAC,CAAC,EAAE,OAAO,QAAQ,IAAI,GAAG;IACjD,OAAO,SAA0B,2BAA2B;AAC9D;AAEO,eAAe,kBAAkB,MAAwB;IAC9D,MAAM,QAAQ,SAAS,CAAC,CAAC,EAAE,OAAO,QAAQ,IAAI,GAAG;IACjD,OAAO,SAA2C,qBAAqB;AACzE;AAkBO,eAAe;IACpB,OAAO,SAAkB;AAC3B;AAEO,eAAe;IACpB,OAAO,SAAS;AAClB;AAeO,eAAe;IACpB,OAAO,SAAwB;AACjC;AAcO,eAAe,aAAa,MAAe;IAChD,MAAM,SAAS,SAAS,CAAC,CAAC,EAAE,QAAQ,GAAG;IACvC,OAAO,SAAqB,CAAC,UAAU,EAAE,QAAQ;AACnD;AAEO,eAAe,cAAc,OAAe,EAAE,OAAY;IAC/D,OAAO,SAAS,CAAC,aAAa,EAAE,SAAS,EAAE;QACzC,QAAQ;QACR,MAAM,KAAK,SAAS,CAAC;IACvB;AACF;AAUO,eAAe;IACpB,OAAO,SAAuB;AAChC;AAeO,eAAe,mBAAmB,OAAO,CAAC,EAAE,WAAW,EAAE;IAC9D,OAAO,SAAS,CAAC,uBAAuB,EAAE,KAAK,WAAW,EAAE,UAAU;AACxE;AAEO,eAAe;IACpB,OAAO,SAAS;AAClB;AAEO,eAAe,sBAAsB,MAAwB;IAClE,OAAO,sIAAS,CAAC,IAAI,CAAC,qBAAqB;QAAE;IAAO;AACtD;AAQO,eAAe;IACpB,OAAO,SAAwB;AACjC;AAEO,eAAe,mBAAmB,OAAe;IACtD,OAAO,sIAAS,CAAC,IAAI,CAAC,CAAC,QAAQ,EAAE,QAAQ,eAAe,CAAC;AAC3D;AAEO,eAAe,aAAa,GAAa;IAC9C,OAAO,sIAAS,CAAC,MAAM,CAAwB,WAAW;QAAE;IAAI;AAClE"}},
    {"offset": {"line": 162, "column": 0}, "map": {"version":3,"sources":["file:///C:/Bots/Git/envio_sla_vista/frontend/components/DashboardDataClient.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useState } from \"react\";\nimport { getDashboardResumo, getDashboardTarefas, getDashboardPizza } from \"../lib/api\";\n\ntype ResumoResponse = Awaited<ReturnType<typeof getDashboardResumo>>;\ntype TarefasResponse = Awaited<ReturnType<typeof getDashboardTarefas>>;\ntype PizzaResponse = Awaited<ReturnType<typeof getDashboardPizza>>;\n\nexport default function DashboardDataClient() {\n  const [resumo, setResumo] = useState<ResumoResponse | null>(null);\n  const [tarefas, setTarefas] = useState<TarefasResponse | null>(null);\n  const [pizza, setPizza] = useState<PizzaResponse | null>(null);\n  const [error, setError] = useState<string | null>(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    let cancelled = false;\n    async function fetchData() {\n      try {\n        const [r, t, p] = await Promise.all([\n          getDashboardResumo(),\n          getDashboardTarefas(),\n          getDashboardPizza()\n        ]);\n        if (!cancelled) {\n          setResumo(r);\n          setTarefas(t);\n          setPizza(p);\n          setLoading(false);\n        }\n      } catch (err: any) {\n        if (!cancelled) {\n          setError(err?.message ?? \"Falha ao carregar dashboard\");\n          setLoading(false);\n        }\n      }\n    }\n    fetchData();\n    return () => {\n      cancelled = true;\n    };\n  }, []);\n\n  if (loading) {\n    return (\n      <div className=\"grid\" style={{ gap: \"1.5rem\" }}>\n        <section className=\"panel\">\n          <h2>Resumo geral</h2>\n          <div className=\"skeleton shimmer\" />\n        </section>\n        <section className=\"panel\">\n          <h2>Tarefas por dia</h2>\n          <div className=\"skeleton shimmer\" style={{ height: 180 }} />\n        </section>\n        <section className=\"panel\">\n          <h2>Distribuição por status</h2>\n          <div className=\"skeleton shimmer\" style={{ height: 120 }} />\n        </section>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <section className=\"panel\">\n        <h2>Dashboard</h2>\n        <p>{error}</p>\n      </section>\n    );\n  }\n\n  const pizzaData = Array.isArray(pizza?.data)\n    ? pizza?.data\n    : Object.entries(pizza?.data ?? {}).map(([status, total]) => ({\n        status,\n        total,\n        cor: \"\"\n      }));\n\n  return (\n    <div className=\"grid\" style={{ gap: \"1.5rem\" }}>\n      <section className=\"panel\">\n        <h2>Resumo geral</h2>\n        <pre style={{ whiteSpace: \"pre-wrap\", margin: 0 }}>{JSON.stringify(resumo?.data, null, 2)}</pre>\n      </section>\n\n      <section className=\"panel\">\n        <h2>Tarefas por dia (mês atual)</h2>\n        <table>\n          <thead>\n            <tr>\n              <th>Dia</th>\n              <th>Finalizadas</th>\n              <th>Não realizadas</th>\n              <th>Em aberto</th>\n              <th>Iniciadas</th>\n            </tr>\n          </thead>\n          <tbody>\n            {(tarefas?.data ?? []).map((item, idx) => (\n              <tr key={idx}>\n                <td>{item.dia}</td>\n                <td>{item.finalizadas}</td>\n                <td>{item.nao_realizadas}</td>\n                <td>{item.em_aberto}</td>\n                <td>{item.iniciadas}</td>\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      </section>\n\n      <section className=\"panel\">\n        <h2>Distribuição por status</h2>\n        <table>\n          <tbody>\n            {pizzaData.map((item: any, idx: number) => (\n              <tr key={idx}>\n                <td style={{ textTransform: \"capitalize\" }}>{item.status?.toString().replace(\"_\", \" \")}</td>\n                <td>{item.total}</td>\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      </section>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}