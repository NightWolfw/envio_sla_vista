{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Bots/Git/envio_sla_vista/frontend/lib/api.ts"],"sourcesContent":["const API_BASE =\n  process.env.NEXT_PUBLIC_API_BASE_URL ?? process.env.API_BASE_URL ?? \"http://localhost:5000/api\";\n\nasync function apiFetch<T>(path: string, init?: RequestInit): Promise<T> {\n  try {\n    const res = await fetch(`${API_BASE}${path}`, {\n      ...init,\n      headers: {\n        \"Content-Type\": \"application/json\",\n        ...(init?.headers ?? {})\n      },\n      cache: \"no-store\",\n      next: { revalidate: 0 }\n    });\n\n    if (!res.ok) {\n      const text = await res.text();\n      throw new Error(`Erro na API (${res.status}): ${text}`);\n    }\n\n    return res.json() as Promise<T>;\n  } catch (error) {\n    console.error(\"Falha ao buscar API\", error);\n    if (\n      error instanceof TypeError ||\n      (error instanceof Error && error.message.toLowerCase().includes(\"fetch failed\"))\n    ) {\n      throw new Error(\n        `N√£o foi poss√≠vel conectar √† API (${API_BASE}). Verifique se o backend FastAPI est√° rodando e se NEXT_PUBLIC_API_BASE_URL est√° configurado.`\n      );\n    }\n    throw error;\n  }\n}\n\nexport type OverviewStats = {\n  total_grupos: number;\n  total_mensagens: number;\n  total_envios: number;\n  generated_at: string;\n};\n\nexport async function getStats(): Promise<OverviewStats> {\n  return apiFetch<OverviewStats>(\"/stats\");\n}\n\nexport async function getDashboardResumo(params?: URLSearchParams) {\n  const query = params ? `?${params.toString()}` : \"\";\n  return apiFetch<{ data: any; periodo: any }>(\"/dashboard/resumo\" + query);\n}\n\nexport async function getDashboardTarefas(params?: URLSearchParams) {\n  const query = params ? `?${params.toString()}` : \"\";\n  return apiFetch<{ data: any[] }>(\"/dashboard/tarefas-mes\" + query);\n}\n\nexport async function getDashboardPizza(params?: URLSearchParams) {\n  const query = params ? `?${params.toString()}` : \"\";\n  return apiFetch<{ data: Record<string, number> }>(\"/dashboard/pizza\" + query);\n}\n\nexport type Grupo = {\n  id: number;\n  group_id: string;\n  nome_grupo: string;\n  envio: boolean;\n  cr?: string | null;\n  cliente?: string | null;\n  pec_01?: string | null;\n  pec_02?: string | null;\n  diretor_executivo?: string | null;\n  diretor_regional?: string | null;\n  gerente_regional?: string | null;\n  gerente?: string | null;\n  supervisor?: string | null;\n};\n\nexport async function getGrupos(): Promise<Grupo[]> {\n  return apiFetch<Grupo[]>(\"/grupos\");\n}\n\nexport async function getGrupoFiltros() {\n  return apiFetch(\"/grupos/filtros/meta\");\n}\n\nexport type Agendamento = {\n  id: number;\n  grupo_id: number;\n  nome_grupo: string;\n  cr: string | null;\n  tipo_envio: string;\n  dias_semana: string | null;\n  data_envio: string;\n  hora_inicio: string;\n  hora_fim: string;\n  ativo: boolean;\n};\n\nexport async function getAgendamentos(): Promise<Agendamento[]> {\n  return apiFetch<Agendamento[]>(\"/agendamentos\");\n}\n\nexport type Mensagem = {\n  id: number;\n  mensagem: string;\n  grupos_ids: string[];\n  tipo_recorrencia: string;\n  dias_semana: number[] | null;\n  horario: string;\n  data_inicio: string;\n  data_fim: string | null;\n  ativo: boolean;\n};\n\nexport async function getMensagens(params?: string): Promise<Mensagem[]> {\n  const suffix = params ? `?${params}` : \"\";\n  return apiFetch<Mensagem[]>(`/mensagens${suffix}`);\n}\n\nexport async function getSlaPreview(grupoId: number, payload: any) {\n  return apiFetch(`/sla/preview/${grupoId}`, {\n    method: \"POST\",\n    body: JSON.stringify(payload)\n  });\n}\n\nexport type EnvioGrupo = {\n  id: number;\n  group_id: string;\n  nome_grupo: string;\n  envio: boolean;\n  cr?: string | null;\n};\n\nexport async function getEnvioGrupos(): Promise<EnvioGrupo[]> {\n  return apiFetch<EnvioGrupo[]>(\"/envio/grupos\");\n}\n\nexport type EvolutionGroup = {\n  group_id: string;\n  nome: string;\n  cr?: string | null;\n};\n\nexport type EvolutionGroupsResponse = {\n  total: number;\n  page: number;\n  page_size: number;\n  grupos: EvolutionGroup[];\n};\n\nexport async function getEvolutionGroups(page = 1, pageSize = 25): Promise<EvolutionGroupsResponse> {\n  return apiFetch(`/evolution/groups?page=${page}&page_size=${pageSize}`);\n}\n\nexport async function importEvolutionGroups(grupos: EvolutionGroup[]) {\n  return clientApi.post(\"/evolution/import\", { grupos });\n}\n\nexport type GrupoCrItem = {\n  id: number;\n  nome_grupo: string;\n  cr: string;\n};\n\nexport async function getGroupsWithCR(): Promise<GrupoCrItem[]> {\n  return apiFetch<GrupoCrItem[]>(\"/grupos/com-cr\");\n}\n\nexport async function syncGroupStructure(grupoId: number) {\n  return clientApi.post(`/grupos/${grupoId}/sync-estrutura`);\n}\n\nexport async function deleteGroups(ids: number[]) {\n  return clientApi.delete<{ removidos: number }>(\"/grupos\", {\n    method: \"DELETE\",\n    body: JSON.stringify({ ids })\n  } as any);\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACE;AADF,MAAM,WACJ,uLAAO,CAAC,GAAG,CAAC,wBAAwB,IAAI,uLAAO,CAAC,GAAG,CAAC,YAAY,IAAI;AAEtE,eAAe,SAAY,IAAY,EAAE,IAAkB;IACzD,IAAI;QACF,MAAM,MAAM,MAAM,MAAM,GAAG,WAAW,MAAM,EAAE;YAC5C,GAAG,IAAI;YACP,SAAS;gBACP,gBAAgB;gBAChB,GAAI,MAAM,WAAW,CAAC,CAAC;YACzB;YACA,OAAO;YACP,MAAM;gBAAE,YAAY;YAAE;QACxB;QAEA,IAAI,CAAC,IAAI,EAAE,EAAE;YACX,MAAM,OAAO,MAAM,IAAI,IAAI;YAC3B,MAAM,IAAI,MAAM,CAAC,aAAa,EAAE,IAAI,MAAM,CAAC,GAAG,EAAE,MAAM;QACxD;QAEA,OAAO,IAAI,IAAI;IACjB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,uBAAuB;QACrC,IACE,iBAAiB,aAChB,iBAAiB,SAAS,MAAM,OAAO,CAAC,WAAW,GAAG,QAAQ,CAAC,iBAChE;YACA,MAAM,IAAI,MACR,CAAC,iCAAiC,EAAE,SAAS,8FAA8F,CAAC;QAEhJ;QACA,MAAM;IACR;AACF;AASO,eAAe;IACpB,OAAO,SAAwB;AACjC;AAEO,eAAe,mBAAmB,MAAwB;IAC/D,MAAM,QAAQ,SAAS,CAAC,CAAC,EAAE,OAAO,QAAQ,IAAI,GAAG;IACjD,OAAO,SAAsC,sBAAsB;AACrE;AAEO,eAAe,oBAAoB,MAAwB;IAChE,MAAM,QAAQ,SAAS,CAAC,CAAC,EAAE,OAAO,QAAQ,IAAI,GAAG;IACjD,OAAO,SAA0B,2BAA2B;AAC9D;AAEO,eAAe,kBAAkB,MAAwB;IAC9D,MAAM,QAAQ,SAAS,CAAC,CAAC,EAAE,OAAO,QAAQ,IAAI,GAAG;IACjD,OAAO,SAA2C,qBAAqB;AACzE;AAkBO,eAAe;IACpB,OAAO,SAAkB;AAC3B;AAEO,eAAe;IACpB,OAAO,SAAS;AAClB;AAeO,eAAe;IACpB,OAAO,SAAwB;AACjC;AAcO,eAAe,aAAa,MAAe;IAChD,MAAM,SAAS,SAAS,CAAC,CAAC,EAAE,QAAQ,GAAG;IACvC,OAAO,SAAqB,CAAC,UAAU,EAAE,QAAQ;AACnD;AAEO,eAAe,cAAc,OAAe,EAAE,OAAY;IAC/D,OAAO,SAAS,CAAC,aAAa,EAAE,SAAS,EAAE;QACzC,QAAQ;QACR,MAAM,KAAK,SAAS,CAAC;IACvB;AACF;AAUO,eAAe;IACpB,OAAO,SAAuB;AAChC;AAeO,eAAe,mBAAmB,OAAO,CAAC,EAAE,WAAW,EAAE;IAC9D,OAAO,SAAS,CAAC,uBAAuB,EAAE,KAAK,WAAW,EAAE,UAAU;AACxE;AAEO,eAAe,sBAAsB,MAAwB;IAClE,OAAO,UAAU,IAAI,CAAC,qBAAqB;QAAE;IAAO;AACtD;AAQO,eAAe;IACpB,OAAO,SAAwB;AACjC;AAEO,eAAe,mBAAmB,OAAe;IACtD,OAAO,UAAU,IAAI,CAAC,CAAC,QAAQ,EAAE,QAAQ,eAAe,CAAC;AAC3D;AAEO,eAAe,aAAa,GAAa;IAC9C,OAAO,UAAU,MAAM,CAAwB,WAAW;QACxD,QAAQ;QACR,MAAM,KAAK,SAAS,CAAC;YAAE;QAAI;IAC7B;AACF"}},
    {"offset": {"line": 130, "column": 0}, "map": {"version":3,"sources":["file:///C:/Bots/Git/envio_sla_vista/frontend/lib/client.ts"],"sourcesContent":["\"use client\";\n\nconst API_BASE = process.env.NEXT_PUBLIC_API_BASE_URL ?? \"http://localhost:5000/api\";\n\ntype Method = \"GET\" | \"POST\" | \"PUT\" | \"DELETE\";\n\nasync function request<T>(path: string, method: Method, body?: unknown): Promise<T> {\n  const res = await fetch(`${API_BASE}${path}`, {\n    method,\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    body: body ? JSON.stringify(body) : undefined\n  });\n\n  if (!res.ok) {\n    const text = await res.text();\n    throw new Error(text || `Erro ${res.status}`);\n  }\n\n  if (res.status === 204) {\n    return {} as T;\n  }\n\n  return res.json() as Promise<T>;\n}\n\nexport const clientApi = {\n  put: <T>(path: string, body?: unknown) => request<T>(path, \"PUT\", body),\n  post: <T>(path: string, body?: unknown) => request<T>(path, \"POST\", body),\n  delete: <T>(path: string, body?: unknown) => request<T>(path, \"DELETE\", body)\n};\n"],"names":[],"mappings":";;;;AAEiB;AAFjB;AAEA,MAAM,WAAW,uLAAO,CAAC,GAAG,CAAC,wBAAwB,IAAI;AAIzD,eAAe,QAAW,IAAY,EAAE,MAAc,EAAE,IAAc;IACpE,MAAM,MAAM,MAAM,MAAM,GAAG,WAAW,MAAM,EAAE;QAC5C;QACA,SAAS;YACP,gBAAgB;QAClB;QACA,MAAM,OAAO,KAAK,SAAS,CAAC,QAAQ;IACtC;IAEA,IAAI,CAAC,IAAI,EAAE,EAAE;QACX,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,MAAM,IAAI,MAAM,QAAQ,CAAC,KAAK,EAAE,IAAI,MAAM,EAAE;IAC9C;IAEA,IAAI,IAAI,MAAM,KAAK,KAAK;QACtB,OAAO,CAAC;IACV;IAEA,OAAO,IAAI,IAAI;AACjB;AAEO,MAAM,YAAY;IACvB,KAAK,CAAI,MAAc,OAAmB,QAAW,MAAM,OAAO;IAClE,MAAM,CAAI,MAAc,OAAmB,QAAW,MAAM,QAAQ;IACpE,QAAQ,CAAI,MAAc,OAAmB,QAAW,MAAM,UAAU;AAC1E"}},
    {"offset": {"line": 166, "column": 0}, "map": {"version":3,"sources":["file:///C:/Bots/Git/envio_sla_vista/frontend/components/EvolutionModal.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useMemo, useState } from \"react\";\nimport { getEvolutionGroups, type EvolutionGroup } from \"../lib/api\";\nimport { clientApi } from \"../lib/client\";\nimport { useRouter } from \"next/navigation\";\n\ntype Props = {\n  onClose: () => void;\n};\n\ntype SelectState = {\n  [group_id: string]: {\n    selected: boolean;\n    cr: string;\n  };\n};\n\nexport default function EvolutionModal({ onClose }: Props) {\n  const router = useRouter();\n  const [page, setPage] = useState(1);\n  const [pageSize] = useState(25);\n  const [total, setTotal] = useState(0);\n  const [items, setItems] = useState<EvolutionGroup[]>([]);\n  const [state, setState] = useState<SelectState>({});\n  const [search, setSearch] = useState(\"\");\n  const [loading, setLoading] = useState(true);\n  const [status, setStatus] = useState<string | null>(null);\n\n  useEffect(() => {\n    let cancelled = false;\n    async function load() {\n      setLoading(true);\n      try {\n        const data = await getEvolutionGroups(page, pageSize);\n        if (!cancelled) {\n          setItems(data.grupos);\n          setTotal(data.total);\n          setState({});\n        }\n      } catch (error: any) {\n        if (!cancelled) setStatus(error.message ?? \"Erro ao carregar grupos da Evolution.\");\n      } finally {\n        if (!cancelled) setLoading(false);\n      }\n    }\n    load();\n    return () => {\n      cancelled = true;\n    };\n  }, [page, pageSize]);\n\n  const filtered = useMemo(() => {\n    const text = search.toLowerCase().trim();\n    if (!text) return items;\n    return items.filter((grupo) => grupo.nome.toLowerCase().includes(text));\n  }, [items, search]);\n\n  function toggleSelect(group: EvolutionGroup) {\n    setState((prev) => ({\n      ...prev,\n      [group.group_id]: {\n        selected: !prev[group.group_id]?.selected,\n        cr: prev[group.group_id]?.cr ?? \"\"\n      }\n    }));\n  }\n\n  function updateCr(group_id: string, cr: string) {\n    setState((prev) => ({\n      ...prev,\n      [group_id]: {\n        selected: prev[group_id]?.selected ?? false,\n        cr\n      }\n    }));\n  }\n\n  async function handleImport() {\n    const selecionados = Object.entries(state)\n      .filter(([, info]) => info.selected)\n      .map(([group_id, info]) => ({\n        group_id,\n        nome: items.find((i) => i.group_id === group_id)?.nome ?? \"\",\n        cr: info.cr || null\n      }));\n\n    if (!selecionados.length) {\n      setStatus(\"Selecione pelo menos um grupo.\");\n      return;\n    }\n\n    try {\n      setStatus(\"Importando grupos...\");\n      await clientApi.post(\"/evolution/import\", { grupos: selecionados });\n      setStatus(\"Importa√ß√£o conclu√≠da! Atualizando lista...\");\n      router.refresh();\n      setTimeout(onClose, 1200);\n    } catch (error: any) {\n      setStatus(error.message ?? \"Erro ao importar grupos.\");\n    }\n  }\n\n  const maxPage = Math.ceil(total / pageSize) || 1;\n\n  return (\n    <div className=\"modal-backdrop\">\n      <div className=\"modal\">\n        <div className=\"modal-header\">\n          <h3>Sincronizar grupos da Evolution</h3>\n          <button type=\"button\" className=\"secondary\" onClick={onClose}>\n            Fechar\n          </button>\n        </div>\n\n        <div style={{ display: \"flex\", gap: \"0.75rem\", marginBottom: \"1rem\" }}>\n          <div style={{ flex: 1, position: \"relative\" }}>\n            <input\n              placeholder=\"Buscar grupos por nome\"\n              value={search}\n              onChange={(e) => setSearch(e.target.value)}\n              style={{ paddingLeft: \"2.5rem\" }}\n            />\n            <span\n              style={{\n                position: \"absolute\",\n                left: \"0.9rem\",\n                top: \"50%\",\n                transform: \"translateY(-50%)\",\n                color: \"var(--text-muted)\"\n              }}\n            >\n              üîé\n            </span>\n          </div>\n          <div style={{ display: \"flex\", alignItems: \"center\", gap: \"0.5rem\" }}>\n            <button type=\"button\" className=\"secondary\" disabled={page <= 1} onClick={() => setPage((p) => Math.max(1, p - 1))}>\n              ‚óÄ\n            </button>\n            <span>\n              P√°gina {page} / {maxPage}\n            </span>\n            <button\n              type=\"button\"\n              className=\"secondary\"\n              disabled={page >= maxPage}\n              onClick={() => setPage((p) => Math.min(maxPage, p + 1))}\n            >\n              ‚ñ∂\n            </button>\n          </div>\n        </div>\n\n        <div style={{ maxHeight: \"320px\", overflowY: \"auto\", border: \"1px solid var(--border)\", borderRadius: \"8px\" }}>\n          {loading ? (\n            <div className=\"skeleton shimmer\" style={{ height: 200 }} />\n          ) : (\n            <table>\n              <thead>\n                <tr>\n                  <th></th>\n                  <th>Nome</th>\n                  <th>Group ID</th>\n                  <th>CR</th>\n                </tr>\n              </thead>\n              <tbody>\n                {filtered.map((grupo) => (\n                  <tr key={grupo.group_id}>\n                    <td>\n                      <input\n                        type=\"checkbox\"\n                        checked={state[grupo.group_id]?.selected ?? false}\n                        onChange={() => toggleSelect(grupo)}\n                      />\n                    </td>\n                    <td>{grupo.nome}</td>\n                    <td>{grupo.group_id}</td>\n                    <td>\n                      <input\n                        placeholder=\"Informe o CR\"\n                        value={state[grupo.group_id]?.cr ?? \"\"}\n                        onChange={(e) => updateCr(grupo.group_id, e.target.value)}\n                      />\n                    </td>\n                  </tr>\n                ))}\n                {!filtered.length && (\n                  <tr>\n                    <td colSpan={4} style={{ textAlign: \"center\", padding: \"1rem\" }}>\n                      Nenhum grupo encontrado.\n                    </td>\n                  </tr>\n                )}\n              </tbody>\n            </table>\n          )}\n        </div>\n\n        {status && <p style={{ marginTop: \"0.75rem\" }}>{status}</p>}\n\n        <div style={{ display: \"flex\", justifyContent: \"flex-end\", gap: \"0.75rem\", marginTop: \"1rem\" }}>\n          <button type=\"button\" className=\"secondary\" onClick={onClose}>\n            Cancelar\n          </button>\n          <button type=\"button\" onClick={handleImport}>\n            Importar selecionados\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 621, "column": 0}, "map": {"version":3,"sources":["file:///C:/Bots/Git/envio_sla_vista/frontend/components/GroupTable.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\nimport type { Grupo } from \"../lib/api\";\nimport { clientApi } from \"../lib/client\";\n\ntype Props = {\n  grupos: Grupo[];\n};\n\nexport default function GroupTable({ grupos }: Props) {\n  const [selected, setSelected] = useState<Grupo | null>(null);\n  const [status, setStatus] = useState<string | null>(null);\n\n  async function handleUpdate(e: React.FormEvent<HTMLFormElement>) {\n    e.preventDefault();\n    if (!selected) return;\n\n    const formData = new FormData(e.currentTarget);\n    try {\n      await clientApi.put(`/grupos/${selected.id}`, {\n        group_id: formData.get(\"group_id\"),\n        nome: formData.get(\"nome_grupo\"),\n        enviar_mensagem: formData.get(\"envio\") === \"on\",\n        cr: formData.get(\"cr\")\n      });\n      setStatus(\"Grupo atualizado! Atualize a p√°gina para ver os dados mais recentes.\");\n    } catch (error: any) {\n      setStatus(error.message ?? \"Erro ao atualizar grupo.\");\n    }\n  }\n\n  return (\n    <div style={{ display: \"grid\", gap: \"1.5rem\" }}>\n      <div style={{ overflowX: \"auto\" }}>\n        <table>\n          <thead>\n            <tr>\n              <th>Nome</th>\n              <th>Group ID</th>\n              <th>CR</th>\n              <th>Envio</th>\n              <th>Cliente</th>\n              <th>Supervisor</th>\n              <th></th>\n            </tr>\n          </thead>\n          <tbody>\n            {grupos.map((grupo) => (\n              <tr key={grupo.id}>\n                <td>{grupo.nome_grupo}</td>\n                <td>{grupo.group_id}</td>\n                <td>{grupo.cr ?? \"‚Äî\"}</td>\n                <td>\n                  <span className=\"chip\">{grupo.envio ? \"Ativo\" : \"Inativo\"}</span>\n                </td>\n                <td>{grupo.cliente ?? \"‚Äî\"}</td>\n                <td>{grupo.supervisor ?? \"‚Äî\"}</td>\n                <td>\n                  <button type=\"button\" onClick={() => setSelected(grupo)}>\n                    Editar\n                  </button>\n                </td>\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      </div>\n\n      {selected && (\n        <form className=\"panel\" onSubmit={handleUpdate}>\n          <h3>Editar grupo: {selected.nome_grupo}</h3>\n          <div className=\"filters-grid\" style={{ gridTemplateColumns: \"repeat(auto-fit,minmax(200px,1fr))\" }}>\n            <label>\n              Group ID\n              <input name=\"group_id\" defaultValue={selected.group_id} required />\n            </label>\n            <label>\n              Nome\n              <input name=\"nome_grupo\" defaultValue={selected.nome_grupo} required />\n            </label>\n            <label>\n              CR\n              <input name=\"cr\" defaultValue={selected.cr ?? \"\"} />\n            </label>\n            <label style={{ display: \"flex\", alignItems: \"center\", gap: \"0.5rem\" }}>\n              <input type=\"checkbox\" name=\"envio\" defaultChecked={selected.envio} />\n              Habilitar envio\n            </label>\n          </div>\n          <button type=\"submit\">Salvar altera√ß√µes</button>\n          {status && <p style={{ marginTop: \"0.5rem\" }}>{status}</p>}\n        </form>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AAEA;;;AAJA;;;AAUe,SAAS,WAAW,EAAE,MAAM,EAAS;;IAClD,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,qLAAQ,EAAe;IACvD,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,qLAAQ,EAAgB;IAEpD,eAAe,aAAa,CAAmC;QAC7D,EAAE,cAAc;QAChB,IAAI,CAAC,UAAU;QAEf,MAAM,WAAW,IAAI,SAAS,EAAE,aAAa;QAC7C,IAAI;YACF,MAAM,yIAAS,CAAC,GAAG,CAAC,CAAC,QAAQ,EAAE,SAAS,EAAE,EAAE,EAAE;gBAC5C,UAAU,SAAS,GAAG,CAAC;gBACvB,MAAM,SAAS,GAAG,CAAC;gBACnB,iBAAiB,SAAS,GAAG,CAAC,aAAa;gBAC3C,IAAI,SAAS,GAAG,CAAC;YACnB;YACA,UAAU;QACZ,EAAE,OAAO,OAAY;YACnB,UAAU,MAAM,OAAO,IAAI;QAC7B;IACF;IAEA,qBACE,yMAAC;QAAI,OAAO;YAAE,SAAS;YAAQ,KAAK;QAAS;;0BAC3C,yMAAC;gBAAI,OAAO;oBAAE,WAAW;gBAAO;0BAC9B,cAAA,yMAAC;;sCACC,yMAAC;sCACC,cAAA,yMAAC;;kDACC,yMAAC;kDAAG;;;;;;kDACJ,yMAAC;kDAAG;;;;;;kDACJ,yMAAC;kDAAG;;;;;;kDACJ,yMAAC;kDAAG;;;;;;kDACJ,yMAAC;kDAAG;;;;;;kDACJ,yMAAC;kDAAG;;;;;;kDACJ,yMAAC;;;;;;;;;;;;;;;;sCAGL,yMAAC;sCACE,OAAO,GAAG,CAAC,CAAC,sBACX,yMAAC;;sDACC,yMAAC;sDAAI,MAAM,UAAU;;;;;;sDACrB,yMAAC;sDAAI,MAAM,QAAQ;;;;;;sDACnB,yMAAC;sDAAI,MAAM,EAAE,IAAI;;;;;;sDACjB,yMAAC;sDACC,cAAA,yMAAC;gDAAK,WAAU;0DAAQ,MAAM,KAAK,GAAG,UAAU;;;;;;;;;;;sDAElD,yMAAC;sDAAI,MAAM,OAAO,IAAI;;;;;;sDACtB,yMAAC;sDAAI,MAAM,UAAU,IAAI;;;;;;sDACzB,yMAAC;sDACC,cAAA,yMAAC;gDAAO,MAAK;gDAAS,SAAS,IAAM,YAAY;0DAAQ;;;;;;;;;;;;mCAVpD,MAAM,EAAE;;;;;;;;;;;;;;;;;;;;;YAoBxB,0BACC,yMAAC;gBAAK,WAAU;gBAAQ,UAAU;;kCAChC,yMAAC;;4BAAG;4BAAe,SAAS,UAAU;;;;;;;kCACtC,yMAAC;wBAAI,WAAU;wBAAe,OAAO;4BAAE,qBAAqB;wBAAqC;;0CAC/F,yMAAC;;oCAAM;kDAEL,yMAAC;wCAAM,MAAK;wCAAW,cAAc,SAAS,QAAQ;wCAAE,QAAQ;;;;;;;;;;;;0CAElE,yMAAC;;oCAAM;kDAEL,yMAAC;wCAAM,MAAK;wCAAa,cAAc,SAAS,UAAU;wCAAE,QAAQ;;;;;;;;;;;;0CAEtE,yMAAC;;oCAAM;kDAEL,yMAAC;wCAAM,MAAK;wCAAK,cAAc,SAAS,EAAE,IAAI;;;;;;;;;;;;0CAEhD,yMAAC;gCAAM,OAAO;oCAAE,SAAS;oCAAQ,YAAY;oCAAU,KAAK;gCAAS;;kDACnE,yMAAC;wCAAM,MAAK;wCAAW,MAAK;wCAAQ,gBAAgB,SAAS,KAAK;;;;;;oCAAI;;;;;;;;;;;;;kCAI1E,yMAAC;wBAAO,MAAK;kCAAS;;;;;;oBACrB,wBAAU,yMAAC;wBAAE,OAAO;4BAAE,WAAW;wBAAS;kCAAI;;;;;;;;;;;;;;;;;;AAKzD;GAtFwB;KAAA"}},
    {"offset": {"line": 959, "column": 0}, "map": {"version":3,"sources":["file:///C:/Bots/Git/envio_sla_vista/frontend/components/GroupsPageClient.tsx"],"sourcesContent":["\"use client\";\n\nimport { useMemo, useState } from \"react\";\nimport type { Grupo } from \"../lib/api\";\nimport EvolutionModal from \"./EvolutionModal\";\nimport GroupTable from \"./GroupTable\";\n\ntype Props = {\n  grupos: Grupo[];\n  filtros: Record<string, string[]>;\n};\n\ntype FiltroState = {\n  diretor_executivo?: string;\n  diretor_regional?: string;\n  gerente_regional?: string;\n  gerente?: string;\n  supervisor?: string;\n  cliente?: string;\n  pec_01?: string;\n  pec_02?: string;\n};\n\nexport default function GroupsPageClient({ grupos, filtros }: Props) {\n  const [search, setSearch] = useState(\"\");\n  const [selectedFilters, setSelectedFilters] = useState<FiltroState>({});\n  const [modalOpen, setModalOpen] = useState(false);\n\n  const filteredGroups = useMemo(() => {\n    const text = search.trim().toLowerCase();\n    return grupos.filter((grupo) => {\n      const matchesSearch =\n        !text ||\n        grupo.nome_grupo.toLowerCase().includes(text) ||\n        grupo.group_id.toLowerCase().includes(text) ||\n        (grupo.cr ?? \"\").toLowerCase().includes(text);\n\n      if (!matchesSearch) return false;\n\n      return Object.entries(selectedFilters).every(([key, value]) => {\n        if (!value) return true;\n        const campo = (grupo as any)[key === \"cliente\" ? \"cliente\" : key.replace(\"_\", \"\")] ?? \"\";\n        return campo === value;\n      });\n    });\n  }, [grupos, search, selectedFilters]);\n\n  function handleFilterChange(key: keyof FiltroState, value: string) {\n    setSelectedFilters((prev) => ({\n      ...prev,\n      [key]: value || undefined\n    }));\n  }\n\n  return (\n    <div className=\"grid\" style={{ gap: \"1.5rem\" }}>\n      <section className=\"panel\">\n        <div style={{ display: \"flex\", justifyContent: \"space-between\", alignItems: \"center\" }}>\n          <h2>Grupos WhatsApp</h2>\n          <button type=\"button\" onClick={() => setModalOpen(true)}>\n            Sincronizar com Evolution\n          </button>\n        </div>\n        <div style={{ display: \"grid\", gap: \"1rem\" }}>\n          <div style={{ position: \"relative\" }}>\n            <input\n              placeholder=\"Pesquisar por nome, group_id ou CR\"\n              value={search}\n              onChange={(e) => setSearch(e.target.value)}\n              style={{ paddingLeft: \"2.5rem\" }}\n            />\n            <span\n              style={{\n                position: \"absolute\",\n                left: \"0.9rem\",\n                top: \"50%\",\n                transform: \"translateY(-50%)\",\n                color: \"var(--text-muted)\"\n              }}\n            >\n              üîç\n            </span>\n          </div>\n\n          <div className=\"filters-grid\">\n            {(\n              [\n                [\"diretor_executivo\", \"Diretor Executivo\"],\n                [\"diretor_regional\", \"Diretor Regional\"],\n                [\"gerente_regional\", \"Gerente Regional\"],\n                [\"gerente\", \"Gerente\"],\n                [\"supervisor\", \"Supervisor\"],\n                [\"cliente\", \"Cliente\"],\n                [\"pec_01\", \"PEC 01\"],\n                [\"pec_02\", \"PEC 02\"]\n              ] as Array<[keyof FiltroState, string]>\n            ).map(([key, label]) => (\n              <label key={key}>\n                {label}\n                <select\n                  value={selectedFilters[key] ?? \"\"}\n                  onChange={(e) => handleFilterChange(key, e.target.value)}\n                >\n                  <option value=\"\">Todos</option>\n                  {(filtros[key === \"cliente\" ? \"cliente\" : key] ?? []).map((valor) => (\n                    <option key={valor} value={valor}>\n                      {valor}\n                    </option>\n                  ))}\n                </select>\n              </label>\n            ))}\n          </div>\n        </div>\n      </section>\n\n      <section className=\"panel\">\n        <GroupTable grupos={filteredGroups} />\n      </section>\n\n      {modalOpen && <EvolutionModal onClose={() => setModalOpen(false)} />}\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}